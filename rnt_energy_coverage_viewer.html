<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RNT Energy Coverage Viewer (Zones Aâ€“D)</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    html, body { height: 100%; margin: 0; }
    #map { height: 100%; }
    .panel { position:absolute; right:10px; top:10px; z-index:1000; background:#fff; padding:12px; border-radius:10px; width:360px; box-shadow:0 8px 30px rgba(2,8,20,.15); font:13px/1.35 system-ui, sans-serif; max-height:calc(100vh - 20px); overflow:auto; }
    .legend { position:absolute; left:10px; bottom:10px; z-index:1000; background:#fff; padding:10px; border-radius:10px; box-shadow:0 8px 30px rgba(2,8,20,.15); font:12px/1.35 system-ui,sans-serif; }
  </style>
</head>
<body>
  <div id="map"></div>
  <div class="panel">
    <h3>RNT Energy Coverage Viewer</h3>
    <p>Load PNG (local file)</p>
    <input id="pngFile" type="file" accept="image/png,image/jpeg" />
    <p>...or Image URL</p>
    <input id="imgUrl" type="text" placeholder="https://your-server/rnt.png" />
    <button id="btnLoadUrl">Load</button>
  </div>
  <div class="legend">
    <div style="font-weight:600; margin-bottom:6px">Legend</div>
    <div><span style="background:#16a34a;width:14px;height:14px;display:inline-block"></span> Zone A</div>
    <div><span style="background:#3b82f6;width:14px;height:14px;display:inline-block"></span> Zone B</div>
    <div><span style="background:#f59e0b;width:14px;height:14px;display:inline-block"></span> Zone C</div>
    <div><span style="background:#ef4444;width:14px;height:14px;display:inline-block"></span> Zone D</div>
  </div>
  <script>
    const map = L.map('map',{crs:L.CRS.Simple,zoomControl:true,minZoom:-3});
    let imageLayer=null; let imgNatural={w:2000,h:1200};
    function fitToImage(){ const b=[[0,0],[imgNatural.h,imgNatural.w]]; map.setMaxBounds(b); map.fitBounds(b); return b; }
    fitToImage();

    function tryLoadImage(src){
      const im=new Image();
      im.onload=()=>{ 
        imgNatural={w:im.naturalWidth,h:im.naturalHeight}; 
        const bounds=fitToImage(); 
        if(imageLayer) map.removeLayer(imageLayer); 
        imageLayer=L.imageOverlay(src,bounds).addTo(map); 
      };
      im.onerror=()=>alert('Failed to load image');
      im.src=src;
    }

    // Load from file
    document.getElementById('pngFile').addEventListener('change',ev=>{ 
      const f=ev.target.files?.[0]; if(!f) return; 
      const r=new FileReader(); 
      r.onload=()=>tryLoadImage(r.result); 
      r.readAsDataURL(f); 
    });

    // Load from URL
    document.getElementById('btnLoadUrl').onclick=()=>{ 
      const u=document.getElementById('imgUrl').value.trim(); 
      if(u) tryLoadImage(u); 
    };

    // Auto-load the uploaded PNG for convenience
    tryLoadImage('mapa-da-rede-2025-dps-2024.png');
  </script>
</body>
</html>
