<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <title>Mobile Operator's Coverage</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- MarkerCluster -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>

  <!-- CSV helper -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <script src="assets/js/coverage_viewer.js"></script>

  <style>
    html, body, #map { height: 100%; margin: 0; }
    .panel {
      position: absolute; right: 10px; top: 10px; z-index: 1000;
      background: #fff; padding: 10px; border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,.15); font: 13px/1.35 system-ui, sans-serif;
      width: 340px; max-width: calc(100vw - 20px);
    }
    .panel h3 { margin: 0 0 6px; font-size: 14px; }
    .row { margin: 6px 0; display: flex; align-items: center; gap: 8px; }
    .row label { white-space: nowrap; }
    .legend {
      position: absolute; left: 10px; bottom: 10px; z-index: 800;
      background: rgba(255,255,255,.9); padding: 8px 10px; border-radius: 6px;
      font: 12px system-ui, sans-serif;
    }
    /* --- barra de info/legenda no canto inferior direito --- */
    .nperf-bar {
      position: absolute; right: 10px; bottom: 10px; z-index: 900;
      display: flex; align-items: center; gap: 12px;
      background: rgba(255,255,255,.92); padding: 8px 10px; border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,.12); font: 12px system-ui, sans-serif;
    }
/* Begin of the new stuff */
    .badge {
      background: rgba(255,255,255,.95); border-radius: 6px; padding: 4px 8px;
      border: 1px solid #e4e4e4; font-weight: 600; color:#333;
    }
    .techs { display:flex; align-items:center; gap:8px; }
    .tech {
      display:flex; align-items:center; gap:6px; font-weight:600;
      color:#333; border:1px solid #e4e4e4; background:#fff; padding:3px 6px; border-radius:14px;
    }
    .dot {
      width:14px; height:14px; border-radius:50%;
      box-shadow: inset 0 0 0 2px rgba(0,0,0,.12);
    }
    .dot.none { background:#bdbdbd; }          /* sem cobertura */
    .dot.g2   { background:#555; }             /* 2G (cinza escuro) */
    .dot.g3   { background:#46c35f; }          /* 3G (verde) */
    .dot.g4   { background:#ff7f32; }          /* 4G / LTE (laranja) */
    .dot.g5   { background:#8e44ad; }          /* 5G (roxo) */

    /* legenda (texto) no canto inferior esquerdo – mantemos curta */
    .legend {
      position: absolute; left: 10px; bottom: 10px; z-index: 800;
      background: rgba(255,255,255,.9); padding: 8px 10px; border-radius: 6px;
      font: 12px system-ui, sans-serif;
    }

    /* End of the new stuff */
  

    .sw { display:inline-block; width:12px; height:12px; border-radius:2px; margin-right:6px; vertical-align:-2px; }
    .sw.unitel { background:#6c3fd6; }
    .sw.africell { background:#d94b4b; }
    .btn { padding: 6px 10px; border: 1px solid #ccc; border-radius: 6px; background:#f6f6f6; cursor:pointer; }
    .drop-hint {
      position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
      background:rgba(0,0,0,.65); color:#fff; padding:8px 12px; border-radius:6px; display:none;
      pointer-events:none; z-index:1200; font:13px system-ui,sans-serif;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <div class="drop-hint" id="dropHint">Largue um CSV (agentes) aqui…</div>

  <div class="panel">
    <h3>Camadas & Dados</h3>

    <div class="row">
      <label><input type="checkbox" id="chkUnitel"> Unitel 4G (nPerf)</label>
      <label><input type="checkbox" id="chkAfricell"> Africell 4G (nPerf)</label>
    </div>

    <div class="row">
      <label style="min-width:80px;">Opacidade</label>
      <input type="range" id="opacity" min="0" max="1" step="0.1" value="0.6" style="flex:1;">
    </div>

    <hr>

    <div class="row"><strong>CSV de agentes</strong></div>
    <div class="row">
      <input type="file" id="csvFile" accept=".csv" />
      <button class="btn" id="clearPoints">Limpar pontos</button>
    </div>
    <div style="color:#666; font-size:12px; margin-top:-2px;">
      Espera colunas como <em>latitude/longitude/nome</em> (auto-detecção: <em>lat, lon, name, displayName</em> etc.).
    </div>
  </div>
  
  <!-- Begin of the new stuff -->
  <!-- Barra tipo nPerf: “Last update” + bolinhas coloridas -->
  <div class="nperf-bar" id="nperfBar">
    <div class="badge" id="lastUpdate">Last update — Unitel: –, Africell: –</div>
    <div class="techs">
      <div class="tech"><span class="dot none"></span><span>Sem</span></div>
      <div class="tech"><span class="dot g2"></span><span>2G</span></div>
      <div class="tech"><span class="dot g3"></span><span>3G</span></div>
      <div class="tech"><span class="dot g4"></span><span>4G</span></div>
      <div class="tech"><span class="dot g5"></span><span>5G</span></div>
    </div>
  </div>
  <!-- End of the new stuff -->

  <div class="legend">
    <div><span class="sw unitel"></span>Unitel 4G (nPerf)</div>
    <div><span class="sw africell"></span>Africell 4G (nPerf)</div>
    <div style="margin-top:6px;color:#666;">• Pode arrastar CSV para o mapa</div>
  </div>
</body>
</html>
